[0m16:19:47.552991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709497db6210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709498c1f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709497db6250>]}


============================== 16:19:47.563272 | 65f80dd1-91b1-41a2-92d2-6289207b160f ==============================
[0m16:19:47.563272 [info ] [MainThread]: Running with dbt=1.11.2
[0m16:19:47.564550 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'profiles_dir': '/app', 'log_path': '/app/logs', 'target_path': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'version_check': 'True', 'empty': 'False', 'write_json': 'True', 'printer_width': '80', 'quiet': 'False', 'partial_parse': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_colors': 'True', 'log_format': 'default'}
[0m16:19:47.735994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65f80dd1-91b1-41a2-92d2-6289207b160f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709497bf19d0>]}
[0m16:19:47.790007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65f80dd1-91b1-41a2-92d2-6289207b160f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70949acbaa50>]}
[0m16:19:47.791457 [info ] [MainThread]: Registered adapter: postgres=1.10.0
[0m16:19:47.858731 [debug] [MainThread]: checksum: 3d40d8bbe1bef07db1c24822f2dbfff8bc07f2a48ed4fe2658a40653aec0b54b, vars: {}, profile: , target: , version: 1.11.2
[0m16:19:47.990493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:19:47.991809 [debug] [MainThread]: Partial parsing: updated file: air_project_london://models/staging/test_connection.sql
[0m16:19:48.224250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65f80dd1-91b1-41a2-92d2-6289207b160f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709496948390>]}
[0m16:19:48.293355 [debug] [MainThread]: Wrote artifact WritableManifest to /app/target/manifest.json
[0m16:19:48.298528 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/target/semantic_manifest.json
[0m16:19:48.373071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65f80dd1-91b1-41a2-92d2-6289207b160f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70949694a810>]}
[0m16:19:48.374255 [info ] [MainThread]: Found 1 model, 1 source, 464 macros
[0m16:19:48.375593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65f80dd1-91b1-41a2-92d2-6289207b160f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709495d9f210>]}
[0m16:19:48.378349 [info ] [MainThread]: 
[0m16:19:48.379678 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:19:48.380914 [info ] [MainThread]: 
[0m16:19:48.382513 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:48.385002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_air_quality_db'
[0m16:19:48.447232 [debug] [ThreadPool]: Using postgres connection "list_air_quality_db"
[0m16:19:48.448462 [debug] [ThreadPool]: On list_air_quality_db: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "air_project_london", "target_name": "dev", "connection_name": "list_air_quality_db"} */

    select distinct nspname from pg_namespace
  
[0m16:19:48.449624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:48.475605 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m16:19:48.477776 [debug] [ThreadPool]: On list_air_quality_db: Close
[0m16:19:48.479975 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_air_quality_db, now list_air_quality_db_public)
[0m16:19:48.486007 [debug] [ThreadPool]: Using postgres connection "list_air_quality_db_public"
[0m16:19:48.486918 [debug] [ThreadPool]: On list_air_quality_db_public: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "air_project_london", "target_name": "dev", "connection_name": "list_air_quality_db_public"} */
select
      'air_quality_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'air_quality_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'air_quality_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:19:48.487846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:48.506655 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.019 seconds
[0m16:19:48.508630 [debug] [ThreadPool]: On list_air_quality_db_public: ROLLBACK
[0m16:19:48.509828 [debug] [ThreadPool]: On list_air_quality_db_public: Close
[0m16:19:48.514368 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:48.515391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "air_project_london", "target_name": "dev", "connection_name": "master"} */
select distinct
        dependent_namespace.nspname as dependent_schema,
        dependent_class.relname as dependent_name,
        referenced_namespace.nspname as referenced_schema,
        referenced_class.relname as referenced_name

    -- Query for views: views are entries in pg_class with an entry in pg_rewrite, but we avoid
    -- a seq scan on pg_rewrite by leveraging the fact there is an "internal" row in pg_depend for
    -- the view...
    from pg_class as dependent_class
    join pg_namespace as dependent_namespace on dependent_namespace.oid = dependent_class.relnamespace
    join pg_depend as dependent_depend on dependent_depend.refobjid = dependent_class.oid
        and dependent_depend.classid = 'pg_rewrite'::regclass
        and dependent_depend.refclassid = 'pg_class'::regclass
        and dependent_depend.deptype = 'i'

    -- ... and via pg_depend (that has a row per column, hence the need for "distinct" above, and
    -- making sure to exclude the internal row to avoid a view appearing to depend on itself)...
    join pg_depend as joining_depend on joining_depend.objid = dependent_depend.objid
        and joining_depend.classid = 'pg_rewrite'::regclass
        and joining_depend.refclassid = 'pg_class'::regclass
        and joining_depend.refobjid != dependent_depend.refobjid

    -- ... we can find the tables they query from in pg_class, but excluding system tables. Note we
    -- don't need need to exclude _dependent_ system tables, because they only query from other
    -- system tables, and so are automatically excluded by excluding _referenced_ system tables
    join pg_class as referenced_class on referenced_class.oid = joining_depend.refobjid
    join pg_namespace as referenced_namespace on referenced_namespace.oid = referenced_class.relnamespace
        and referenced_namespace.nspname != 'information_schema'
        and referenced_namespace.nspname not like 'pg\_%'

    order by
        dependent_schema, dependent_name, referenced_schema, referenced_name;
[0m16:19:48.516155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:48.534761 [debug] [MainThread]: SQL status: SELECT 0 in 0.019 seconds
[0m16:19:48.536749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65f80dd1-91b1-41a2-92d2-6289207b160f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70949691c850>]}
[0m16:19:48.538100 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:48.539282 [debug] [MainThread]: On master: COMMIT
[0m16:19:48.540292 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:48.541119 [debug] [MainThread]: On master: COMMIT
[0m16:19:48.542240 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:19:48.542858 [debug] [MainThread]: On master: Close
[0m16:19:48.547815 [debug] [Thread-1 (]: Began running node model.air_project_london.test_connection
[0m16:19:48.548836 [info ] [Thread-1 (]: 1 of 1 START sql table model public.test_connection ............................ [RUN]
[0m16:19:48.549858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_air_quality_db_public, now model.air_project_london.test_connection)
[0m16:19:48.550676 [debug] [Thread-1 (]: Began compiling node model.air_project_london.test_connection
[0m16:19:48.559383 [debug] [Thread-1 (]: Writing injected SQL for node "model.air_project_london.test_connection"
[0m16:19:48.567399 [debug] [Thread-1 (]: Began executing node model.air_project_london.test_connection
[0m16:19:48.600754 [debug] [Thread-1 (]: Writing runtime sql for node "model.air_project_london.test_connection"
[0m16:19:48.609928 [debug] [Thread-1 (]: Using postgres connection "model.air_project_london.test_connection"
[0m16:19:48.611124 [debug] [Thread-1 (]: On model.air_project_london.test_connection: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "air_project_london", "target_name": "dev", "node_id": "model.air_project_london.test_connection"} */

  
    

  create  table "air_quality_db"."public"."test_connection__dbt_tmp"
  
  
    as
  
  (
    

WITH raw_data AS (
    -- Read
    SELECT * FROM "air_quality_db"."public"."london_raw_data"
)

SELECT
    id,
    ingestion_time,
    -- Just trying :) 
    raw_data->>'station_name' as station,
    raw_data->>'parameter' as pollutant,
    (raw_data->>'value')::numeric as value
FROM raw_data
  );
  
[0m16:19:48.611921 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:49.458048 [debug] [Thread-1 (]: SQL status: SELECT 114509 in 0.846 seconds
[0m16:19:49.468646 [debug] [Thread-1 (]: Using postgres connection "model.air_project_london.test_connection"
[0m16:19:49.470132 [debug] [Thread-1 (]: On model.air_project_london.test_connection: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "air_project_london", "target_name": "dev", "node_id": "model.air_project_london.test_connection"} */
alter table "air_quality_db"."public"."test_connection" rename to "test_connection__dbt_backup"
[0m16:19:49.472505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:19:49.475514 [debug] [Thread-1 (]: Using postgres connection "model.air_project_london.test_connection"
[0m16:19:49.476242 [debug] [Thread-1 (]: On model.air_project_london.test_connection: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "air_project_london", "target_name": "dev", "node_id": "model.air_project_london.test_connection"} */
alter table "air_quality_db"."public"."test_connection__dbt_tmp" rename to "test_connection"
[0m16:19:49.477353 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m16:19:49.491957 [debug] [Thread-1 (]: On model.air_project_london.test_connection: COMMIT
[0m16:19:49.493285 [debug] [Thread-1 (]: Using postgres connection "model.air_project_london.test_connection"
[0m16:19:49.494333 [debug] [Thread-1 (]: On model.air_project_london.test_connection: COMMIT
[0m16:19:49.502027 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m16:19:49.508017 [debug] [Thread-1 (]: Applying DROP to: "air_quality_db"."public"."test_connection__dbt_backup"
[0m16:19:49.513241 [debug] [Thread-1 (]: Using postgres connection "model.air_project_london.test_connection"
[0m16:19:49.514287 [debug] [Thread-1 (]: On model.air_project_london.test_connection: /* {"app": "dbt", "dbt_version": "1.11.2", "profile_name": "air_project_london", "target_name": "dev", "node_id": "model.air_project_london.test_connection"} */
drop table if exists "air_quality_db"."public"."test_connection__dbt_backup" cascade
[0m16:19:49.526501 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.011 seconds
[0m16:19:49.529568 [debug] [Thread-1 (]: On model.air_project_london.test_connection: Close
[0m16:19:49.531946 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65f80dd1-91b1-41a2-92d2-6289207b160f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709494281250>]}
[0m16:19:49.533482 [info ] [Thread-1 (]: 1 of 1 OK created sql table model public.test_connection ....................... [[32mSELECT 114509[0m in 0.98s]
[0m16:19:49.535024 [debug] [Thread-1 (]: Finished running node model.air_project_london.test_connection
[0m16:19:49.537137 [debug] [MainThread]: On master: COMMIT
[0m16:19:49.537830 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:49.538478 [debug] [MainThread]: On master: COMMIT
[0m16:19:49.539093 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:49.548542 [debug] [MainThread]: SQL status: COMMIT in 0.009 seconds
[0m16:19:49.549865 [debug] [MainThread]: On master: Close
[0m16:19:49.551052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:49.551993 [debug] [MainThread]: Connection 'model.air_project_london.test_connection' was properly closed.
[0m16:19:49.553062 [info ] [MainThread]: 
[0m16:19:49.554079 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.17 seconds (1.17s).
[0m16:19:49.555787 [debug] [MainThread]: Command end result
[0m16:19:49.589910 [debug] [MainThread]: Wrote artifact WritableManifest to /app/target/manifest.json
[0m16:19:49.597683 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/target/semantic_manifest.json
[0m16:19:49.609531 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/target/run_results.json
[0m16:19:49.610738 [info ] [MainThread]: 
[0m16:19:49.611880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:49.612974 [info ] [MainThread]: 
[0m16:19:49.614094 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:19:49.616072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1308, "process_in_blocks": "0", "process_kernel_time": 0.649465, "process_mem_max_rss": "130000", "process_out_blocks": "2240", "process_user_time": 2.079882}
[0m16:19:49.617075 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:49.616953 after 2.13 seconds
[0m16:19:49.617824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709497d4b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70949c6ec610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709497db5510>]}
[0m16:19:49.618602 [debug] [MainThread]: Flushing usage events
[0m16:19:50.114199 [debug] [MainThread]: An error was encountered while trying to flush usage events
